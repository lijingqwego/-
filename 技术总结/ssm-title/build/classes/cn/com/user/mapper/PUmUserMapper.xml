<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.user.mapper.PUmUserMapper">
  <resultMap id="BaseResultMap" type="cn.com.user.pojo.PUmUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Aug 01 16:23:39 CST 2017.
    -->
    <id column="USERID" jdbcType="VARCHAR" property="userid" />
    <result column="LOGINID" jdbcType="VARCHAR" property="loginid" />
    <result column="USERNAME" jdbcType="VARCHAR" property="username" />
    <result column="PASSWORD" jdbcType="VARCHAR" property="password" />
    <result column="USERTYPE" jdbcType="DECIMAL" property="usertype" />
    <result column="USERFLAG" jdbcType="DECIMAL" property="userflag" />
    <result column="LOGINCOUNT" jdbcType="DECIMAL" property="logincount" />
    <result column="ENABLED" jdbcType="DECIMAL" property="enabled" />
    <result column="LOGINLASTTIME" jdbcType="DATE" property="loginlasttime" />
    <result column="ISSYS" jdbcType="DECIMAL" property="issys" />
    <result column="CREATE_TIME" jdbcType="DATE" property="createTime" />
    <result column="UPDATE_TIME" jdbcType="DATE" property="updateTime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Aug 01 16:23:39 CST 2017.
    -->
    USERID, LOGINID, USERNAME, PASSWORD, USERTYPE, USERFLAG, LOGINCOUNT, ENABLED, LOGINLASTTIME, 
    ISSYS, CREATE_TIME, UPDATE_TIME
  </sql>
  <select id="selectByLoginid" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Aug 01 16:23:39 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from P_UM_USER
    where LOGINID = #{loginid,jdbcType=VARCHAR}
  </select>
  <select id="findByUserid" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Aug 01 16:23:39 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from P_UM_USER
    where USERID = #{userid,jdbcType=VARCHAR}
  </select>
  <select id="findBySearch" parameterType="java.util.HashMap" resultMap="BaseResultMap">
  	SELECT * FROM 
  	( SELECT A.*, ROWNUM RN FROM 
	  	( select <include refid="Base_Column_List" />
		  	from P_UM_USER 
		  	<where>
		  		<if test="loginid !=null and loginid !=''">
		  			and loginid like concat(concat('%',#{loginid}),'%')
		  		</if>
		  		<if test="username !=null and username !=''">
		  			and username like concat(concat('%',#{username}),'%')
		  		</if>
		  		and userflag=1
		  	</where>
		 ) A WHERE ROWNUM &lt;= #{endnum}
	) WHERE RN &gt;= #{startnum}
  </select>
  <select id="check" parameterType="java.util.HashMap" resultType="java.lang.Integer">
  	 select count(*) from P_UM_USER
  	 where USERID = #{userid,jdbcType=VARCHAR} 
  	 and LOGINID = #{loginid,jdbcType=VARCHAR}
  	 and userflag=1
  </select>
  <select id="checkByLoginid" parameterType="java.lang.String" resultType="java.lang.Integer">
  	 select count(*) from P_UM_USER
  	 where LOGINID = #{loginid,jdbcType=VARCHAR} and userflag=1
  </select>
  <insert id="insertSelective" parameterType="cn.com.user.pojo.PUmUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Aug 01 16:23:39 CST 2017.
    -->
     insert into P_UM_USER
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="userid != null">
        USERID,
      </if>
      <if test="loginid != null">
        LOGINID,
      </if>
      <if test="username != null">
        USERNAME,
      </if>
      <if test="password != null">
        PASSWORD,
      </if>
      <if test="usertype != null">
        USERTYPE,
      </if>
      <if test="userflag != null">
        USERFLAG,
      </if>
      LOGINCOUNT,LOGINLASTTIME,CREATE_TIME,UPDATE_TIME
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="userid != null">
        #{userid,jdbcType=VARCHAR},
      </if>
      <if test="loginid != null">
        #{loginid,jdbcType=VARCHAR},
      </if>
      <if test="username != null">
        #{username,jdbcType=VARCHAR},
      </if>
      <if test="password != null">
        #{password,jdbcType=VARCHAR},
      </if>
      <if test="usertype != null">
        #{usertype,jdbcType=DECIMAL},
      </if>
      <if test="userflag != null">
        #{userflag,jdbcType=DECIMAL},
      </if>
      1,sysdate,sysdate,sysdate
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="cn.com.user.pojo.PUmUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Aug 01 16:23:39 CST 2017.
    -->
    update P_UM_USER
    <set>
      <if test="username != null">
        USERNAME = #{username,jdbcType=VARCHAR},
      </if>
        UPDATE_TIME = sysdate,
    </set>
    where USERID = #{userid,jdbcType=VARCHAR}
  </update>
  <update id="updateLogin" parameterType="java.lang.String">
  	update P_UM_USER
  	set LOGINLASTTIME = sysdate,
  		LOGINCOUNT = (logincount+1)
  		where LOGINID = #{loginid,jdbcType=VARCHAR}
  </update>
  <update id="updatePassword" parameterType="java.util.HashMap">
  	update P_UM_USER
  	set PASSWORD = #{newpassword,jdbcType=VARCHAR},
  		UPDATE_TIME = sysdate
  		where LOGINID = #{loginid,jdbcType=VARCHAR}
  </update>
  <update id="updateUsername" parameterType="java.util.HashMap">
  	update P_UM_USER
  	set USERNAME = #{username,jdbcType=VARCHAR},
  		UPDATE_TIME = sysdate
  		where LOGINID = #{loginid,jdbcType=VARCHAR}
  </update>
  <update id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Aug 05 09:17:46 CST 2017.
    -->
    update P_UM_USER
  	set USERFLAG=0
  		where USERID = #{userid,jdbcType=VARCHAR}
  </update>
</mapper>